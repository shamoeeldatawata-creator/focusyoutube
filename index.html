<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Fix for Error 153: Ensures the browser sends the necessary referrer info to YouTube -->
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>FocusTube - Distraction Free Learning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #0a0a0a;
            color: #efefef;
        }
        .video-card:hover img {
            transform: scale(1.05);
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #444;
        }
        iframe {
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }
    </style>
</head>
<body class="custom-scrollbar min-h-screen flex flex-col">

    <!-- Header / Search Bar -->
    <header id="search-header" class="p-6 md:p-12 transition-all duration-500">
        <div class="max-w-3xl mx-auto text-center">
            <h1 class="text-4xl md:text-6xl font-black mb-4 tracking-tighter">
                FOCUS<span class="text-red-600">TUBE</span>
            </h1>
            <p class="text-gray-400 mb-8 font-light italic">Search. Watch. Learn. No Traps.</p>
            
            <div class="relative flex items-center">
                <input 
                    type="text" 
                    id="search-input" 
                    placeholder="What do you want to learn?" 
                    class="w-full bg-zinc-900 border border-zinc-800 rounded-full py-4 px-8 text-lg focus:outline-none focus:ring-2 focus:ring-red-600 focus:border-transparent transition-all"
                    onkeypress="if(event.key === 'Enter') performSearch()"
                >
                <button 
                    onclick="performSearch()"
                    class="absolute right-2 bg-red-600 hover:bg-red-700 text-white p-3 rounded-full transition-colors"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Results Area -->
    <main id="results-area" class="flex-grow container mx-auto px-6 pb-20">
        <div id="status-msg" class="text-center text-gray-500 mt-10">
            Enter a keyword above to start learning without distractions.
        </div>
        <div id="video-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            <!-- Videos will appear here -->
        </div>
    </main>

    <!-- Fullscreen Player Overlay -->
    <div id="player-overlay" class="fixed inset-0 bg-black z-50 flex flex-col items-center justify-center hidden opacity-0 transition-opacity duration-500">
        <button 
            onclick="exitPlayer()"
            class="absolute top-6 left-6 text-white hover:text-red-500 flex items-center gap-2 font-medium z-50 transition-colors"
        >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
            BACK TO SEARCH
        </button>
        
        <div class="w-full max-w-6xl aspect-video bg-zinc-900" id="iframe-container">
            <!-- Iframe injected here -->
        </div>
        
        <div class="mt-8 text-center px-6">
            <h2 id="playing-title" class="text-xl md:text-2xl font-bold text-gray-300"></h2>
            <p class="text-zinc-500 mt-2 italic">You are in Focus Mode. No suggestions, just your video.</p>
        </div>
    </div>

    <script>
        const API_KEY = 'AIzaSyA4z6nqFaDwHLU1ATkGzZEQUpeUmXsKCh4';

        async function performSearch() {
            const input = document.getElementById('search-input');
            const query = input.value.trim();
            const grid = document.getElementById('video-grid');
            const status = document.getElementById('status-msg');

            if (!query) return;

            grid.innerHTML = '';
            status.innerHTML = '<div class="flex items-center justify-center gap-3"><div class="animate-spin rounded-full h-6 w-6 border-b-2 border-red-600"></div> Searching...</div>';

            try {
                const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=16&q=${encodeURIComponent(query)}&type=video&key=${API_KEY}`);
                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error.message);
                }

                if (!data.items || data.items.length === 0) {
                    status.innerText = "No results found. Try another search.";
                    return;
                }

                status.classList.add('hidden');
                
                data.items.forEach(video => {
                    const videoId = video.id.videoId;
                    const title = video.snippet.title;
                    const thumb = video.snippet.thumbnails.high.url;
                    
                    const card = document.createElement('div');
                    card.className = "video-card group cursor-pointer space-y-3";
                    card.onclick = () => launchVideo(videoId, title);
                    
                    card.innerHTML = `
                        <div class="overflow-hidden rounded-xl bg-zinc-800 aspect-video relative">
                            <img src="${thumb}" class="w-full h-full object-cover transition-transform duration-500" alt="${title}">
                            <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all flex items-center justify-center">
                                <div class="bg-red-600 rounded-full p-3 opacity-0 group-hover:opacity-100 transform translate-y-4 group-hover:translate-y-0 transition-all">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M8 5v14l11-7z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="font-semibold text-sm line-clamp-2 text-zinc-300 group-hover:text-white transition-colors">
                            ${title}
                        </h3>
                    `;
                    grid.appendChild(card);
                });

            } catch (error) {
                status.classList.remove('hidden');
                status.innerText = "Error: " + error.message;
                console.error(error);
            }
        }

        function launchVideo(id, title) {
            const overlay = document.getElementById('player-overlay');
            const container = document.getElementById('iframe-container');
            const titleEl = document.getElementById('playing-title');
            
            titleEl.innerText = title;
            
            // referrerpolicy="strict-origin-when-cross-origin" is key to fixing Error 153
            container.innerHTML = `
                <iframe 
                    width="100%" 
                    height="100%" 
                    src="https://www.youtube.com/embed/${id}?autoplay=1&rel=0&modestbranding=1&iv_load_policy=3" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    referrerpolicy="strict-origin-when-cross-origin"
                    allowfullscreen>
                </iframe>
            `;

            overlay.classList.remove('hidden');
            setTimeout(() => {
                overlay.classList.remove('opacity-0');
                document.body.style.overflow = 'hidden';
            }, 10);
        }

        function exitPlayer() {
            const overlay = document.getElementById('player-overlay');
            const container = document.getElementById('iframe-container');

            overlay.classList.add('opacity-0');
            setTimeout(() => {
                overlay.classList.add('hidden');
                container.innerHTML = ''; 
                document.body.style.overflow = 'auto';
            }, 500);
        }
    </script>
</body>
</html>